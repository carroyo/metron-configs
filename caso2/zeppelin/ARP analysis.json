{"paragraphs":[{"text":"%spark\n/**\n* date_sub_hours: Subtract an hours worth of seconds from a timestamp\n*/\ndef date_sub_hours(t:Long, h:Int) : Long = {\n    t - h*3600000\n}\n\n/**\n* source_ip_address: Provides the same Source IP Address to all reports\n*/\nvar srcIp = z.input(\"Source IP Address\")\ndef source_ip_address() : String = {\n    srcIp.toString\n}\n\n//Register udfs\nsqlc.udf.register(\"source_ip_address\", source_ip_address _)\nsqlc.udf.register(\"date_sub_hours\", date_sub_hours _)\n\n//Load snmp Data \nval snmparp = sqlc.read.json(\"hdfs:///apps/metron/indexing/indexed/snmparp\")\nsnmparp.registerTempTable(\"snmparp\")\n\n","dateUpdated":"2017-11-27T19:59:36+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","editorHide":false},"settings":{"params":{"Source IP Address":"*"},"forms":{"Source IP Address":{"name":"Source IP Address","displayName":"Source IP Address","type":"input","defaultValue":"","hidden":false}}},"jobName":"paragraph_1510768482722_1058829783","id":"20171115-175442_752406354","result":{"code":"SUCCESS","type":"TEXT","msg":"date_sub_hours: (t: Long, h: Int)Long\nsrcIp: Object = *\nsource_ip_address: ()String\nres44: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function0>,StringType,List())\nres45: org.apache.spark.sql.UserDefinedFunction = UserDefinedFunction(<function2>,LongType,List(LongType, IntegerType))\nsnmparp: org.apache.spark.sql.DataFrame = [enrichmentjoinbolt.joiner.ts: string, enrichmentsplitterbolt.splitter.begin.ts: string, enrichmentsplitterbolt.splitter.end.ts: string, guid: string, ip_src_addr: string, mac: string, original_string: string, source.type: string, threatinteljoinbolt.joiner.ts: string, threatintelsplitterbolt.splitter.begin.ts: string, threatintelsplitterbolt.splitter.end.ts: string, timestamp: bigint]\n"},"dateCreated":"2017-11-15T17:54:42+0000","dateStarted":"2017-11-27T19:59:36+0000","dateFinished":"2017-11-27T19:59:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:402","focus":true},{"text":"%spark.sql\nSELECT\n    ip_src_addr,\n    COUNT(*) as count\nFROM snmparp\nGROUP BY ip_src_addr\n\n","dateUpdated":"2017-11-27T19:59:56+0000","config":{"colWidth":12,"graph":{"mode":"lineChart","height":300,"optionOpen":false,"keys":[{"name":"ip_src_addr","index":0,"aggr":"sum"}],"values":[{"name":"count","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"ip_src_addr","index":0,"aggr":"sum"},"yAxis":{"name":"count","index":1,"aggr":"sum"}}},"enabled":true},"settings":{"params":{"Number of Rows":"100000"},"forms":{}},"jobName":"paragraph_1510768765498_495186324","id":"20171115-175925_10322795","result":{"code":"SUCCESS","type":"TABLE","msg":"ip_src_addr\tcount\n192.168.10.1\t285294\n192.168.10.2\t282811\n192.168.10.4\t282812\n192.168.10.7\t282192\n192.168.10.8\t282812\n192.168.10.12\t281342\n192.168.10.14\t282810\n192.168.10.17\t280720\n192.168.10.18\t282189\n","comment":"","msgTable":[[{"key":"count","value":"192.168.10.1"},{"key":"count","value":"285294"}],[{"value":"192.168.10.2"},{"value":"282811"}],[{"value":"192.168.10.4"},{"value":"282812"}],[{"value":"192.168.10.7"},{"value":"282192"}],[{"value":"192.168.10.8"},{"value":"282812"}],[{"value":"192.168.10.12"},{"value":"281342"}],[{"value":"192.168.10.14"},{"value":"282810"}],[{"value":"192.168.10.17"},{"value":"280720"}],[{"value":"192.168.10.18"},{"value":"282189"}]],"columnNames":[{"name":"ip_src_addr","index":0,"aggr":"sum"},{"name":"count","index":1,"aggr":"sum"}],"rows":[["192.168.10.1","285294"],["192.168.10.2","282811"],["192.168.10.4","282812"],["192.168.10.7","282192"],["192.168.10.8","282812"],["192.168.10.12","281342"],["192.168.10.14","282810"],["192.168.10.17","280720"],["192.168.10.18","282189"]]},"dateCreated":"2017-11-15T17:59:25+0000","dateStarted":"2017-11-27T19:59:37+0000","dateFinished":"2017-11-27T19:59:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:403"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1510768805788_-218260730","id":"20171115-180005_2125103649","dateCreated":"2017-11-15T18:00:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:404","dateUpdated":"2017-11-27T19:59:36+0000","dateFinished":"2017-11-27T19:59:49+0000","dateStarted":"2017-11-27T19:59:44+0000","result":{"code":"SUCCESS","type":"TEXT","msg":""}}],"name":"ARP analysis","id":"2CZ8PFGEB","angularObjects":{"2CZNMY27H:shared_process":[],"2CX2SCYP3:shared_process":[],"2CY1QBW3K:shared_process":[],"2CZ99CNUF:shared_process":[],"2CXYG8MXF:shared_process":[],"2CY9X8NSY:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}